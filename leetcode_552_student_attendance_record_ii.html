<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Leetcode: 552. Student Attendance Record II</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="style.css">
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<!--  --><nav><span class="nav-header">Problem Solving</span><span class="nav-items"><a href="index.html">Home</a><span></nav><div id="content" class="content">
<h1 class="title">Leetcode: 552. Student Attendance Record II</h1>
<p>
<a href="https://leetcode.com/problems/student-attendance-record-ii/">Problem Statement</a>
</p>

<ul class="org-ul">
<li><a href="mistake_did_not_try_hard_to_solve_alternative_problem.html#ID-AC9291C6-4C72-4143-80F2-0D414EF7B681">Mistake: Did not try hard to solve alternative problem</a>.  I found that I had to treat records with <code>A</code> separately, but I didn't try hard to find its formula.  Instead, I work the recurrence with <code>A</code>, <code>L</code>, and <code>P</code> which is way more complex than the first one.</li>

<li><a href="mistake_high_constant_factor_in_the_implementation.html#ID-56B18554-8EDB-44AF-B72A-8FD307B2980C">Mistake: High constant factor in the implementation</a>.  Python's map is slow when looking up \(10^5\) elements.</li>

<li><a href="can_you_break_down_the_problem_in_small_and_easily_to_solve_parts.html#ID-69D68202-BF1A-4D72-A0EC-DDCBAF112500">Can we break-down the problem in small and easily to solve parts?</a>  Be \(f(d, s)\) the number of different records ending with status \(s\) on the day \(d\).  Be \(g(d)\) the number of different records with \(d\) days.  If there is no absence, then we have at least \(x=f(d, L)+f(d, P)\) different records.  For each day \(i\) that we can be absent, we have \(y=\max(1, f(i-1,L)+f(i-1,P)) \times \max(1, f(n - i, L) + f(n - i, P))\) possible records.  So, \(g(d)=x+y\).  Time and space complexity is \(O(n)\).</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Solution</span>:
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">checkRecord</span>(<span style="font-weight: bold;">self</span>, n: <span style="font-weight: bold;">int</span>) -&gt; <span style="font-weight: bold;">int</span>:
        MOD = 10**9 + 7
        <span style="font-weight: bold; font-style: italic;">ans</span> = 0

        <span style="font-weight: bold; font-style: italic;">L</span> = 0
        <span style="font-weight: bold; font-style: italic;">P</span> = 1
        <span style="font-weight: bold; font-style: italic;">dp</span> = [[0, 0] <span style="font-weight: bold;">for</span> _ <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(n + 2)]

        dp[0][<span style="font-weight: bold; font-style: italic;">L</span>] = dp[0][<span style="font-weight: bold; font-style: italic;">P</span>] = 0
        dp[1][<span style="font-weight: bold; font-style: italic;">L</span>] = dp[1][<span style="font-weight: bold; font-style: italic;">P</span>] = 1
        dp[2][<span style="font-weight: bold; font-style: italic;">L</span>] = dp[2][<span style="font-weight: bold; font-style: italic;">P</span>] = 2

        <span style="font-weight: bold;">for</span> day <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(3, n + 1):
            dp[day][<span style="font-weight: bold; font-style: italic;">L</span>] = (dp[day - 2][P] + dp[day - 1][P]) % MOD
            dp[day][<span style="font-weight: bold; font-style: italic;">P</span>] = (dp[day - 1][L] + dp[day - 1][P]) % MOD

        <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">a</span>(day):
            <span style="font-weight: bold;">return</span> (dp[day][L] + dp[day][P]) % MOD

        <span style="font-weight: bold; font-style: italic;">ans</span> = a(n)
        <span style="font-weight: bold;">for</span> day <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(1, n + 1):
            <span style="font-weight: bold; font-style: italic;">ans</span> = (ans + <span style="font-weight: bold;">max</span>(a(day - 1), 1) * <span style="font-weight: bold;">max</span>(a(n - day), 1)) % MOD
        <span style="font-weight: bold;">return</span> ans


<span style="font-weight: bold;">assert</span> Solution().checkRecord(2) == 8
<span style="font-weight: bold;">assert</span> Solution().checkRecord(1) == 3
<span style="font-weight: bold;">assert</span> Solution().checkRecord(10101) == 183236316
</pre>
</div>

<ul class="org-ul">
<li><a href="how_can_we_extend_the_solution_for_i_to_i_1.html#ID-45B9F3C8-D007-4980-95EF-4361906245A8">How can we extend the solution for \(i\) to \(i+1\)?</a>  The valid suffixes for a record are \(XP\), \(YPL\) and \(ZPLL\), where \(X\), \(Y\) and \(Z\) are records of size \(n-1, n-2\) and \(n-3\) respectively.  As these suffixes are mutually exclusive, we can compute the number of different records with only <code>L</code> and <code>P</code> as \(f(d)=f(d-1)+f(d-2)+f(d-3)\).  To compute \(g(d)\), we use the same trick as the above solution.  Time and space complexity is \(O(n)\).</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Solution</span>:
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">checkRecord</span>(<span style="font-weight: bold;">self</span>, n: <span style="font-weight: bold;">int</span>) -&gt; <span style="font-weight: bold;">int</span>:
        MOD = 10**9 + 7

        <span style="font-weight: bold; font-style: italic;">dp</span> = [0] * (n + 10)
        <span style="font-weight: bold; font-style: italic;">dp</span>[0] = 1
        <span style="font-weight: bold; font-style: italic;">dp</span>[1] = 2
        <span style="font-weight: bold; font-style: italic;">dp</span>[2] = 4
        <span style="font-weight: bold; font-style: italic;">dp</span>[3] = 7

        <span style="font-weight: bold;">for</span> day <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(4, n + 1):
            <span style="font-weight: bold; font-style: italic;">dp</span>[<span style="font-weight: bold; font-style: italic;">day</span>] = (dp[day - 1] + dp[day - 2] + dp[day - 3]) % MOD

        <span style="font-weight: bold; font-style: italic;">ans</span> = dp[n]
        <span style="font-weight: bold;">for</span> day <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(1, n + 1):
            <span style="font-weight: bold; font-style: italic;">ans</span> = (ans + dp[day - 1] * dp[n - day]) % MOD
        <span style="font-weight: bold;">return</span> ans


<span style="font-weight: bold;">assert</span> Solution().checkRecord(2) == 8
<span style="font-weight: bold;">assert</span> Solution().checkRecord(1) == 3
<span style="font-weight: bold;">assert</span> Solution().checkRecord(10101) == 183236316
</pre>
</div>
</div>
</body>
</html>