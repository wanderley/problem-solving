<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Leetcode: 1335. Minimum Difficulty of a Job Schedule</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" href="style.css">
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<!--  --><nav><span class="nav-header">Problem Solving</span><span class="nav-items"><a href="index.html">Home</a><span></nav><div id="content" class="content">
<h1 class="title">Leetcode: 1335. Minimum Difficulty of a Job Schedule</h1>
<p>
<a href="https://leetcode.com/problems/minimum-difficulty-of-a-job-schedule/">Problem Statement</a>
</p>

<ul class="org-ul">
<li><a href="pattern_find_optimal_partition_of_array.html#ID-4060A2EA-09E8-4E05-922D-8340AAF60F44">Pattern: Find optimal partition of array</a>.  Split the jobs in all possible partitions respecting the number of days.  The base case is when there is only one day which should be the max of all remaining jobs.  Time complexity is \(O(n^2 \times d)\) and space is \(O(n \times d)\).</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> typing <span style="font-weight: bold;">import</span> List


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Solution</span>:
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">minDifficulty</span>(<span style="font-weight: bold;">self</span>, job: List[<span style="font-weight: bold;">int</span>], d: <span style="font-weight: bold;">int</span>) -&gt; <span style="font-weight: bold;">int</span>:
        N = <span style="font-weight: bold;">len</span>(job)

        <span style="font-weight: bold; text-decoration: underline;">@cache</span>
        <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">dfs</span>(i, d):
            <span style="font-weight: bold;">if</span> d == 1:
                <span style="font-weight: bold;">return</span> <span style="font-weight: bold;">max</span>(job[i:])
            best = <span style="font-weight: bold;">float</span>(<span style="font-style: italic;">"inf"</span>)
            maxv = <span style="font-weight: bold;">float</span>(<span style="font-style: italic;">"-inf"</span>)
            <span style="font-weight: bold;">for</span> j <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(i, N - d + 1):
                maxv = <span style="font-weight: bold;">max</span>(maxv, job[j])
                <span style="font-weight: bold;">if</span> maxv &lt; best:
                    best = <span style="font-weight: bold;">min</span>(best, maxv + dfs(j + 1, d - 1))
            <span style="font-weight: bold;">return</span> best

        <span style="font-weight: bold;">return</span> -1 <span style="font-weight: bold;">if</span> dfs(0, d) == <span style="font-weight: bold;">float</span>(<span style="font-style: italic;">"inf"</span>) <span style="font-weight: bold;">else</span> dfs(0, d)
</pre>
</div>

<ul class="org-ul">
<li>Alternative solution.  As the priority of each job is small, we can use it as parameter of the search and delay the computation of the cost of day to when we make a transition to the next one.  Time complexity is \(O(n \times m \times d)\) and space is \(O(n \times m \times d)\).</li>
</ul>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> typing <span style="font-weight: bold;">import</span> List


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Solution</span>:
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">minDifficulty</span>(<span style="font-weight: bold;">self</span>, job: List[<span style="font-weight: bold;">int</span>], d: <span style="font-weight: bold;">int</span>) -&gt; <span style="font-weight: bold;">int</span>:
        N = <span style="font-weight: bold;">len</span>(job)

        <span style="font-weight: bold; text-decoration: underline;">@cache</span>
        <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">dfs</span>(i, cur, d):
            <span style="font-weight: bold;">if</span> i == N:
                <span style="font-weight: bold;">return</span> cur <span style="font-weight: bold;">if</span> d == 0 <span style="font-weight: bold;">else</span> <span style="font-weight: bold;">float</span>(<span style="font-style: italic;">"inf"</span>)
            <span style="font-weight: bold;">return</span> <span style="font-weight: bold;">min</span>(
                dfs(i + 1, <span style="font-weight: bold;">max</span>(cur, job[i]), d), <span style="font-weight: bold;">max</span>(cur, job[i]) + dfs(i + 1, 0, d - 1)
            )

        <span style="font-weight: bold;">return</span> -1 <span style="font-weight: bold;">if</span> dfs(0, 0, d) == <span style="font-weight: bold;">float</span>(<span style="font-style: italic;">"inf"</span>) <span style="font-weight: bold;">else</span> dfs(0, 0, d)
</pre>
</div>
</div>
</body>
</html>